<!doctype html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="charset=utf-8">
    <title>.gif-tile</title>
    <script src="https://code.jquery.com/jquery.min.js"></script>
    <style type="text/css">
      span#menuBg {
      background: #fff;
      }
    </style>
    <script type="text/javascript">
      $( document ).ready(function() {
        /*  Show/hide menu
        Credits to Utkanos on StackOverflow
        http://stackoverflow.com/a/18562295

        TODO: show/hide menu *button* too, on mousemove anywhere in the document
        */
        var menu = $('#menu'), but = $('#menu_button');
        $(document).on('click', '*', function(evt) {
          evt.stopPropagation();
          if ($(this).is(but))
            menu.toggle();
            else if (!$(this).closest(menu).length)
              menu.hide();
            });

            /*  Update the page with the given URLs
            TODO: Rewrite w/jQuery, cause I'm too lazy to learn it
            */
            function update(imgUrl, audioUrl) {
              // Use fixed CSS variable
              document.body.style.backgroundImage = 'url('+imgUrl+')';
              var audioElement = document.getElementById("bgAudio");
              audioElement.setAttribute('src', audioUrl);
            };
            // Get the URLs from the form
            var updateButton = document.getElementById("updateButton");
            var imgUrl = document.getElementById("imgUrlEl").value;
            var audioUrl = document.getElementById("audioUrlEl").value;
            updateButton.addEventListener("click", function() { var imgUrl = document.getElementById("imgUrlEl").value;
            var audioUrl = document.getElementById("audioUrlEl").value; update(imgUrl, audioUrl); }, false);
          });
    </script>
  </head>
  <body>
    <!--<script>
      document.body.style.backgroundImage='url('+prompt('Enter a URL to an image:', 'http://')+')';
      audioUrl = prompt("Enter an (optional) URL to an audio file your browser supports:");
      if (void 0 != audioUrl)
      	{
      		var audio = document.createElement('audio');
      		audio.setAttribute('src', audioUrl);
      		audio.setAttribute('preload', 'auto');
      		audio.setAttribute('autoplay', '');
      }
      </script>-->
    <audio id="bgAudio" preload="auto" autoplay loop></audio>
    <button id='menu_button'>Options/About</button>
    <div id='menu'>
      <span id='menuBg'>
      Enter a URL to an image:<br />
      <input id="imgUrlEl" type="url" /><br />
      Enter a URL to an audio file your browser supports:<br />
      <input id="audioUrlEl" type="url" /><br />
      <button id="removeButton">Remove audio</button>
      <button id="updateButton">Update</button><br />
      <b>giftile</b> tiles a .gif (or other image) and loops an audio file.<br />
      Useful for .gifs that "dance to anything".<br />
      <a href="https://github.com/benjabean1/giftile">Fork me on GitHub</a>
      </span>
    </div>
    <script>
      var removeButton = document.getElementById("removeButton");
      removeButton.addEventListener("click", function() {
        var bgAudio = document.getElementById("bgAudio");
        bgAudio.pause();
        document.getElementById("bgAudio").removeAttribute("src");
      })
    </script>
  </body>
</html>
